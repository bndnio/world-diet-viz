(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{159:function(e,t,a){e.exports=a(282)},164:function(e,t,a){},165:function(e,t,a){},243:function(e,t,a){},256:function(e,t,a){},259:function(e,t,a){},260:function(e,t,a){},278:function(e,t,a){},282:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(10),o=a.n(i),c=(a(164),a(13)),s=a(14),l=a(16),u=a(15),p=a(17),h=(a(165),a(71),a(42)),d=(a(79),a(20)),f=a(65),m=(a(169),a(95)),y=a(39),g=(a(142),a(68)),b=(a(118),a(92)),v=a(32),O=a.n(v),j=a(40),x=n.createContext();function C(e){return function(t){return n.createElement(x.Consumer,null,function(a){return n.createElement(e,Object.assign({},t,{data:a}))})}}var E=n.createContext();function S(e){return function(t){return n.createElement(E.Consumer,null,function(a){return n.createElement(e,Object.assign({},t,{interaction:a}))})}}function k(){var e=Object(y.a)(["\n      {\n        countries\n      }\n    "]);return k=function(){return e},e}var w=b.a.Text,D=g.a.Option,A=S(C(function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){a.props.data.setQuery({countries:e||[]}),a.props.interaction.setFields({availableCountries:e||[]})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=O()(k());return r.a.createElement(j.b,{query:t},function(t){var a=t.loading,n=t.error,i=t.data;if(a)return"Loading...";n&&console.log("Error loading gql data for CountryPicker");var o=i.countries;return r.a.createElement("div",null,r.a.createElement(w,null,"Country"),r.a.createElement(g.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select",defaultValue:[],onChange:e.handleChange,value:e.props.interaction.fields.availableCountries},o.map(function(e){return r.a.createElement(D,{key:e},e)})))})}}]),t}(n.Component))),P=a(45),M=a(41),Y=a(21),F=a(150),N=a.n(F),L=g.a.Option,R=function(e){return r.a.createElement(g.a,Object.assign({},e,{showSearch:!0,style:{width:200},placeholder:e.placeholder||"Select one",optionFilterProp:"children",onChange:function(t){e.handleChange(t)},filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}}),e.options.map(function(e,t){return r.a.createElement(L,{key:e.value||t,value:e.value||e},e.display||e)}))},q={"Grand Total - Animal Protein - Food supply":"Animal Protein","Grand Total - Carbs - Food supply":"Carbs","Grand Total - Fat - Food supply":"Fat","Grand Total - Food supply":"Grand Total","Grand Total - Plant Protein - Food supply":"Plant Protein","Grand Total - Protein - Food supply":"Protein"};a(243);function T(){var e=Object(y.a)(["\n      {\n        kcalRange {\n          max\n        }\n      }\n    "]);return T=function(){return e},e}var W={width:800,height:389,padding:50},X=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderXAxis()}},{key:"componentDidUpdate",value:function(){this.renderXAxis()}},{key:"renderXAxis",value:function(){var e=this.refs.axisContainer,t=Y.a().ticks(5).tickFormat(Y.e("d")).scale(this.props.scale);Y.i(e).call(t)}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component),z=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderYAxis()}},{key:"componentDidUpdate",value:function(){this.renderYAxis()}},{key:"renderYAxis",value:function(){var e=this.refs.axisContainer,t=(this.props.flip?Y.c():Y.b()).ticks(5).scale(this.props.scale);Y.i(e).call(t)}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("g",{className:"LE-xy-axis"},r.a.createElement(X,{translate:"translate(0, ".concat(this.props.height-this.props.padding,")"),scale:this.props.xScale}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(".concat(W.width/2-this.props.padding/2,", ").concat(W.height-5,")")},"[year]"),r.a.createElement(z,{translate:"translate(".concat(this.props.padding,", 0)"),scale:this.props.yScale}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(10, ".concat(W.height/2,"), rotate(-90)")},"[total kCal]"),r.a.createElement(z,{translate:"translate(".concat(W.width-this.props.padding,", 0)"),scale:this.props.otherYScale,flip:!0}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(".concat(W.width-10,", ").concat(W.height/2,"), rotate(-90)")},"[Mean Age of Death]"))}}]),t}(r.a.Component),B=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderLine=function(e,t){return r.a.createElement("line",{x1:a.props.xScale(e[0]),y1:a.props.yScale(e[1]),x2:a.props.xScale(e[2]),y2:a.props.yScale(e[3]),strokeWidth:1.5,stroke:a.props.color,key:t})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("g",null,this.props.data.map(this.renderLine))}}]),t}(r.a.Component),U=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.xScale,a=e.yScale,n=e.data,i=e.color;return r.a.createElement(r.a.Fragment,null,r.a.createElement(V,{xScale:t,yScale:a,data:n,color:i}),r.a.createElement(B,{xScale:t,yScale:a,data:n,color:N()(i).darken(.1)}))}}]),t}(n.Component),V=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderFillBottom=function(e,t){return r.a.createElement("polygon",{points:"\n        ".concat(a.props.xScale(e[0]),",").concat(a.props.yScale(0),"\n        ").concat(a.props.xScale(e[2]),",").concat(a.props.yScale(0),"\n        ").concat(a.props.xScale(e[2]),",").concat(a.props.yScale(e[3]),"\n        ").concat(a.props.xScale(e[0]),",").concat(a.props.yScale(e[1]),"\n        "),fill:a.props.color,key:t})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("g",null,this.props.data.map(this.renderFillBottom))}}]),t}(r.a.Component),I=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getXScale",value:function(){var e=this.props.interaction.fields.availableYears,t=e[0],a=e[e.length-1];return Y.h().domain([t,a]).range([this.props.padding,this.props.width-this.props.padding])}},{key:"getDataYScale",value:function(){return Y.h().domain([0,this.props.kcalMax]).range([this.props.height-this.props.padding,this.props.padding/2])}},{key:"getDeathYScale",value:function(){return Y.h().domain([20,80]).range([this.props.height-this.props.padding,this.props.padding/2])}},{key:"render",value:function(){var e=this.getXScale(),t=this.getDataYScale(),a=this.getDeathYScale();return r.a.createElement("svg",{width:this.props.width,height:this.props.height},r.a.createElement(U,{xScale:e,yScale:t,data:this.props.measure4,color:"#70b678"}),r.a.createElement(U,{xScale:e,yScale:t,data:this.props.measure3,color:"#bbdbad"}),r.a.createElement(U,{xScale:e,yScale:t,data:this.props.measure2,color:"#c79fc8"}),r.a.createElement(U,{xScale:e,yScale:t,data:this.props.measure1,color:"#f4a58a"}),r.a.createElement(B,Object.assign({xScale:e,yScale:a},this.props,{data:this.props.deathData,color:"#444444"})),r.a.createElement(G,Object.assign({xScale:e,yScale:t,otherYScale:a},this.props)))}}]),t}(r.a.Component),Q=S(C(function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.processData()}},{key:"componentDidUpdate",value:function(e){e.data.data===this.props.data.data&&e.interaction.fields.selectedCountry===this.props.interaction.fields.selectedCountry||this.processData()}},{key:"processData",value:function(){var e=this.props.interaction.fields.selectedCountry,t=[];e&&(t=this.props.data.data.map(function(t){return[t.year,t.countries.filter(function(t){return t.country===e})[0].items.reduce(function(e,t){return Object(M.a)({},e,Object(P.a)({},q[t.name],t.value))},{})]})),this.setState({data:t,totalData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1]["Grand Total"],a[t-1][0],a[t-1][1]["Grand Total"]]}).filter(function(e){return!!e}),deathData:t.map(function(e){return[e[0],65+10*(Math.random()-.5)]}).map(function(e,t,a){return 0===t?void 0:[e[0],e[1],a[t-1][0],a[t-1][1]]}).filter(function(e){return!!e}),carbData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1].Carbs,a[t-1][0],a[t-1][1].Carbs]}).filter(function(e){return!!e}),fatData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1].Carbs+e[1].Fat,a[t-1][0],a[t-1][1].Carbs+a[t-1][1].Fat]}).filter(function(e){return!!e}),animalProteinData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1].Carbs+e[1].Fat+e[1]["Animal Protein"],a[t-1][0],a[t-1][1].Carbs+a[t-1][1].Fat+a[t-1][1]["Animal Protein"]]}).filter(function(e){return!!e}),plantProteinData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1].Carbs+e[1].Fat+e[1]["Animal Protein"]+e[1]["Plant Protein"],a[t-1][0],a[t-1][1].Carbs+a[t-1][1].Fat+a[t-1][1]["Animal Protein"]+a[t-1][1]["Plant Protein"]]}).filter(function(e){return!!e})})}},{key:"render",value:function(){var e=this,t=O()(T());return r.a.createElement(h.a,{size:"small",bodyStyle:{width:824,height:413},title:"Life Expectancy v. Total kCal Consumption",extra:r.a.createElement(R,{options:this.props.interaction.fields.availableCountries||[],handleChange:function(t){return e.props.interaction.setFields({selectedCountry:t})},disabled:!!this.props.data.loading||!this.props.interaction.fields.availableCountries,placeholder:"Select Country"})},r.a.createElement(j.b,{query:t},function(t){var a=t.loading,n=t.error,i=t.data;if(e.props.data.loading||a)return"Loading...";n&&console.log("Error loading gql data for LineChart");var o=i.kcalRange.max;return e.props.interaction.fields.selectedCountry?r.a.createElement(I,Object.assign({},e.props,{data:e.state.totalData,deathData:e.state.deathData,measure1:e.state.carbData,measure2:e.state.fatData,measure3:e.state.animalProteinData,measure4:e.state.plantProteinData,kcalMax:o},W)):"select a country"}))}}]),t}(r.a.Component))),J=(a(256),{width:500,height:400,padding:50}),K=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderXAxis()}},{key:"componentDidUpdate",value:function(){this.renderXAxis()}},{key:"renderXAxis",value:function(){var e=this.refs.axisContainer,t=Y.a().ticks(5).tickFormat(Y.e("d")).scale(this.props.scale);Y.i(e).call(t)}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component),H=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderYAxis()}},{key:"componentDidUpdate",value:function(){this.renderYAxis()}},{key:"renderYAxis",value:function(){var e=this.refs.axisContainer,t=(this.props.flip?Y.c():Y.b()).ticks(5).scale(this.props.scale);Y.i(e).call(t)}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component),$=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("g",{className:"LE-xy-axis"},r.a.createElement(K,{translate:"translate(0, ".concat(this.props.height-this.props.padding,")"),scale:this.props.xScale}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(".concat(J.width/2-this.props.padding/2,", ").concat(J.height-10,")")},"[Total KCals]"),r.a.createElement(H,{translate:"translate(".concat(this.props.padding,", 0)"),scale:this.props.yScale}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(10, ".concat(J.height/2,"), rotate(-90)")},"[Life Expectancy]"))}}]),t}(r.a.Component),_=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={hovered:!1},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getCircleRadius",value:function(e){return 2.5*Math.sqrt(e/Math.PI)}},{key:"renderCircle",value:function(e){var t=this;return r.a.createElement("svg",null,r.a.createElement("circle",{cx:this.props.xScale(e[2]),cy:this.props.yScale(e[3]),r:this.getCircleRadius(e[4]),key:Math.random(),fill:this.state.hovered?"red":this.props.color,onMouseDown:function(){return t.setState({hovered:!0})},onMouseUp:function(){return t.setState({hovered:!1})}}),r.a.createElement("text",{className:"data_labels",x:this.props.xScale(e[2])+this.getCircleRadius(e[4]),y:this.props.yScale(e[3])-3},e[0]))}},{key:"render",value:function(){return r.a.createElement("g",null,this.props.data.map(this.renderCircle.bind(this)))}}]),t}(r.a.Component),Z=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getXScale",value:function(){return Y.h().domain([2e3,2350]).range([this.props.padding,this.props.width-this.props.padding/2])}},{key:"getDataYScale",value:function(){return Y.h().domain([50,100]).range([this.props.height-this.props.padding,this.props.padding/2])}},{key:"render",value:function(){var e=this.getXScale(),t=this.getDataYScale();return r.a.createElement("svg",{width:this.props.width,height:this.props.height},r.a.createElement(_,Object.assign({xScale:e,yScale:t},this.props,{data:this.props.data,color:"#80b0ff"})),r.a.createElement($,Object.assign({xScale:e,yScale:t},this.props)))}}]),t}(r.a.Component),ee=C(function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.getData()}},{key:"getData",value:function(){this.setState({data:[["Canada",2012,2055,83,100],["Oh Im sorry I thought this was Amurica",2012,2056,76,10],["A",2012,2008,91,100],["B",2012,2061,78,10],["C",2012,2164,88,100],["D",2012,2162,64,1],["E",2012,2323,76,1],["F",2012,2159,78,100],["G",2012,2308,59,10],["H",2012,2183,86,10],["I",2012,2155,89,10],["J",2012,2124,79,100],["K",2012,2124,74,100],["L",2012,2126,76,1],["M",2012,2199,58,1],["N",2012,2228,99,100],["Pop: 1",2012,2025,100,1],["Pop: 10",2012,2025,90,10],["Pop: 50",2012,2025,80,50],["Pop: 100",2012,2025,70,100],["Pop: 1000",2012,2025,50,1e3]]})}},{key:"render",value:function(){return r.a.createElement(h.a,{size:"small",title:"Life Expectancy v. Total kcal"},r.a.createElement(Z,Object.assign({data:this.state.data},J)))}}]),t}(n.Component)),te=a(155),ae=a(66),ne=a.n(ae),re=a(91),ie=(a(259),["ALIGN","FOLLOW"]),oe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).renderAxis=function(){var e=a.refs.axisContainer,t=("bottom"===a.props.orient?Y.a():"top"===a.props.orient?Y.d():"left"===a.props.orient?Y.b():null).ticks(5).scale(a.props.scale);Y.i(e).call(t)},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderAxis()}},{key:"componentDidUpdate",value:function(){this.renderAxis()}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component),ce=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.settings,t=e.padding,a=e.width,n=e.height,i=e.mode;return r.a.createElement("g",{className:"xy-axis"},r.a.createElement(oe,{translate:"translate(0, ".concat(t,")"),scale:this.props.xScale,orient:"top"}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(".concat(a/2,", 15)")},"[kCal / person / day]"),r.a.createElement(oe,{translate:i===ie[1]?"translate(".concat(t,", 0)"):"translate(".concat(a/2,", 0)"),scale:this.props.yScale,orient:"left"}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:i===ie[1]?"translate(".concat(t,", ").concat(n-t+20,"), rotate(-90)"):"translate(".concat(a/2,", ").concat(n-t+15,")")},"[year]"))}}]),t}(r.a.Component),se=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderRect=function(e){var t=a.props.settings;if(t.mode===ie[0])var n=t.width/2-a.props.xScale(e.xDiff),i=Math.abs(n),o=n>0?a.props.xScale(e.xDiff):t.width/2;else t.mode===ie[1]&&(n=a.props.xScale(e.xAbs)-a.props.xScale(e.xLast),i=Math.abs(n),o=e.xDiff>0?a.props.xScale(e.xLast):a.props.xScale(e.xAbs));return r.a.createElement("rect",{x:o,y:a.props.yScale(e.year),width:i,height:(t.height-2*t.padding)/t.numDataPoints,className:e.xDiff>0?"goodBar":"badBar",key:1*Math.random()})},a.renderRectText=function(e){var t=a.props.settings;if(t.mode===ie[0])var n=t.width/2-a.props.xScale(e.xDiff),i=t.width/2-n;else t.mode===ie[1]&&(n=a.props.xScale(e.xAbs)-a.props.xScale(e.xLast),i=a.props.xScale(e.xLast)+(e.xDiff>0?3:-3));return r.a.createElement("text",{textAnchor:e.xDiff>0?"start":"end",x:i,y:a.props.yScale(e.year)+t.height/t.numDataPoints/2+3,key:1*Math.random()},e.xDiff>0&&"+",e.xDiff.toFixed(1))},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("g",null,this.props.data.map(this.renderRect),this.props.data.map(this.renderRectText))}}]),t}(r.a.Component),le=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getXScale=function(){var e=a.props.settings;if(e.mode===ie[0])var t=Y.g(a.props.data,function(e){return e.xDiff}),n=Y.f(a.props.data,function(e){return e.xDiff});else e.mode===ie[1]&&(t=Y.g(a.props.data.map(function(e){return[e.xAbs,e.xLast]}).flat()),n=Y.f(a.props.data.map(function(e){return[e.xAbs,e.xLast]}).flat()));var r=Y.f([Math.abs(t),Math.abs(n)]);return Y.h().domain([e.mode===ie[0]?-r:t,r]).range([e.padding,e.width-e.padding])},a.getYScale=function(){var e=a.props.settings,t=Y.g(a.props.data,function(e){return e.year}),n=Y.f(a.props.data,function(e){return e.year});return Y.h().domain([t,n+1]).range([e.padding,e.height-e.padding])},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.settings,t=this.props.xScale||this.getXScale(),a=this.props.xScale||this.getYScale();return r.a.createElement("svg",{width:e.width,height:e.height},r.a.createElement(se,Object.assign({xScale:t,yScale:a},this.props)),r.a.createElement(ce,Object.assign({xScale:t,yScale:a},this.props)))}}]),t}(r.a.Component),ue=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={mode:ie[1],data:[]},a.toggleMode=function(){var e=a.state.mode;e===ie[0]?a.setState({mode:ie[1]}):e===ie[1]&&a.setState({mode:ie[0]})},a.processData=function(){var e=a.props.data.map(function(e,t,a){return 0!==t?{year:e[0],xLast:a[t-1][1],xDiff:e[1]-a[t-1][1],xAbs:e[1]}:null}).filter(function(e){return!!e});a.setState({data:e})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.processData()}},{key:"componentDidUpdate",value:function(e){e.data!==this.props.data&&this.processData()}},{key:"render",value:function(){var e=this.props,t=e.settings,a=e.country,n=e.group;return r.a.createElement(h.a,{size:"small",bodyStyle:{width:324,height:424},title:"".concat(a," - ").concat(q[n]),extra:r.a.createElement("div",{className:"vizMenuExtra"},r.a.createElement(d.a,{type:"swap",theme:"outlined",onClick:this.toggleMode}),r.a.createElement(d.a,{type:"setting",theme:"filled",onClick:this.props.toggleView}),r.a.createElement(d.a,{type:"close",theme:"outlined",onClick:this.props.handleClose}))},r.a.createElement(le,{data:this.state.data,settings:Object(M.a)({},t,{numDataPoints:this.state.data.length+1,mode:this.state.mode})}))}}]),t}(n.Component);ue.defaultProps={settings:{width:300,height:400,padding:40,baseYear:1985,numDataPoints:30,maxRange:function(){return 100*Math.random()}}};var pe=ue,he=(a(96),a(93));a(260);function de(){var e=Object(y.a)(["\n      {\n        names(type: MACRO)\n      }\n    "]);return de=function(){return e},e}var fe=S(function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.interaction.fields.availableCountries,a=this.props,n=a.country,i=a.group,o=O()(de()),c=function(t){return function(a){e.props.handleChange(Object(P.a)({},t,a))}};return r.a.createElement(j.b,{query:o},function(a){var o=a.loading,s=a.error,l=a.data;return s&&console.log("Error loading gql data for WaterfallConfig"),r.a.createElement(h.a,{size:"small",bodyStyle:{width:324,height:424},title:"Waterfall Config",extra:r.a.createElement(d.a,{type:"close",theme:"outlined",onClick:e.props.handleClose}),loading:o},!o&&r.a.createElement("div",{className:"WaterfallConfig"},r.a.createElement(R,{placeholder:"Select a country",options:t,handleChange:c("country"),value:n||void 0}),r.a.createElement(R,{placeholder:"Select a group",options:l.names.map(function(e){return{value:e,display:q[e]}}),handleChange:c("group"),value:i||void 0}),r.a.createElement(he.a,{type:"primary",onClick:e.props.toggleView},"Visualize")))})}}]),t}(n.Component)),me=C(function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={displayConfig:!0,country:null,group:null,data:[]},a.toggleView=function(){a.setState(function(e){return{displayConfig:!e.displayConfig}})},a.handleChange=function(){var e=Object(re.a)(ne.a.mark(function e(t){return ne.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState(Object(M.a)({},t));case 2:a.filterData();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.filterData=function(){var e=a.state,t=e.country,n=e.group,r=[];t&&n&&(r=a.props.data.data.map(function(e){return[e.year,e.countries.filter(function(e){return e.country===t})[0].items.filter(function(e){return e.name===n})[0].value]})),a.setState({data:r})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){e.data.data!==this.props.data.data&&this.filterData()}},{key:"render",value:function(){var e=this.state,t=e.data,a=Object(te.a)(e,["data"]);return r.a.createElement("div",null,this.state.displayConfig?r.a.createElement(fe,Object.assign({handleChange:this.handleChange,toggleView:this.toggleView,handleClose:this.props.handleClose},a)):r.a.createElement(pe,Object.assign({},this.props,a,{toggleView:this.toggleView,handleClose:this.props.handleClose,data:t})))}}]),t}(n.Component)),ye=(a(261),a(153));function ge(){var e=Object(y.a)(["\n      {\n        yearRange {\n          min\n          max\n        }\n      }\n    "]);return ge=function(){return e},e}var be=b.a.Text,ve=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleChange=function(e){a.setState({value:e})},a.handleRelease=function(e){var t=Object(f.a)(Array(e[1]-e[0]+1).keys()).map(function(t){return e[0]+t});a.props.data.setQuery({years:t}),a.props.interaction.setFields({availableYears:t})};var n=a.props,r=n.min,i=n.max;return a.handleRelease([r,i]),a.state={value:[r,i]},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.interaction.fields.availableYears;e.interaction.fields.availableYears!==t&&this.setState({value:[t[0],t[t.length-1]]})}},{key:"render",value:function(){var e,t=this.props,a=t.min,n=t.max;return r.a.createElement("div",null,r.a.createElement(be,null,"Year"),r.a.createElement(ye.a,{range:!0,min:a,max:n,marks:(e={},Object(P.a)(e,a,a),Object(P.a)(e,n,n),e),onChange:this.handleChange,onAfterChange:this.handleRelease,value:this.state.value}))}}]),t}(n.Component),Oe=S(C(function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=O()(ge());return r.a.createElement(j.b,{query:t},function(t){var a=t.loading,n=t.error,i=t.data;if(a)return"Loading...";n&&console.log("Error loading gql data for YearRangeSliderContainer");var o=i.yearRange,c=o.min,s=o.max;return r.a.createElement(ve,Object.assign({},e.props,{min:c,max:s}))})}}]),t}(n.Component))),je=S(C(function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){var e=a.props,t=e.yearRange,n=e.countries,r=e.selectedYear,i=e.selectedCountry,o={},c={};if(t){var s=Object(f.a)(Array(t[1]-t[0]+1).keys()).map(function(e){return t[0]+e});o.years=s,c.availableYears=s}n&&(o.countries=n,c.availableCountries=n),r&&(c.selectedYear=r),i&&(c.selectedCountry=i),0!==Object.keys(o).length&&a.props.data.setQuery(o),0!==Object.keys(c).length&&a.props.interaction.setFields(c)},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(he.a,{onClick:this.handleClick},this.props.children)}}]),t}(n.Component))),xe=(a(278),m.a.Sider),Ce=m.a.Content,Ee=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={waterfalls:[],waterfallCount:0},a.handleCloseWaterfall=function(e){return function(){a.setState(function(t){return{waterfalls:t.waterfalls.filter(function(t){return+t.key!==e})}})}},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(m.a,{style:{height:"100vh"}},r.a.createElement(xe,{theme:"light",className:"sideBar"},r.a.createElement("h1",{className:"App-title"},"Nutrition InfoViz"),r.a.createElement(A,null),r.a.createElement(Oe,null),r.a.createElement(je,{countries:["Canada","Afghanistan","Mexico"],yearRange:[1990,2e3]},"Preset 1")),r.a.createElement(Ce,{className:"dashboard"},r.a.createElement(ee,null),r.a.createElement(Q,null),this.state.waterfalls,r.a.createElement(h.a,{size:"small",hoverable:!0,bodyStyle:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around",width:"200px",height:"120px"},onClick:function(){return e.setState(function(t){return{waterfalls:[].concat(Object(f.a)(t.waterfalls),[r.a.createElement(me,{key:t.waterfallCount,handleClose:e.handleCloseWaterfall(t.waterfallCount)})]),waterfallCount:t.waterfallCount+1}})}},"Waterfall",r.a.createElement("br",null),r.a.createElement(d.a,{type:"plus",theme:"outlined",style:{fontSize:30}}))))}}]),t}(n.Component),Se=a(154);function ke(){var e=Object(y.a)(["\n          {\n            itemByYearCountry(\n              ","\n              ","\n              ","\n            )\n              {\n              year\n              countries {\n                country\n                items {\n                  country\n                  year\n                  type\n                  name\n                  value\n                }\n              }\n            }\n          }\n        "]);return ke=function(){return e},e}var we=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).setQuery=function(){var t=Object(re.a)(ne.a.mark(function t(a){return ne.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState(function(e){return{queryParams:Object(M.a)({},e.queryParams,a)}});case 2:e.getData();case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.setData=function(t){e.setState(function(e){return{data:t,loading:e.loading-1}})},e.getData=function(){var t=e.state.queryParams,a=t.years,n=t.countries,r=t.type;if(e.setState(function(e){return{loading:e.loading+1}}),0===a.length||0===n.length)return e.setData([]);e.client.query({query:O()(ke(),a.length>0?"years:".concat(JSON.stringify(a),", "):"",n.length>0?"countries:".concat(JSON.stringify(n),", "):"",r?"type:".concat(r):"")}).then(function(t){return e.setData(t.data.itemByYearCountry)}).catch(function(e){return console.log(e)})},e.state={setDate:e.setData,setQuery:e.setQuery,data:[],queryParams:{type:"MACRO",countries:[],years:[]},loading:0},e.client=new Se.a({uri:"http://gql.healthviz.xyz/graphql"}),e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.createElement(x.Provider,{value:this.state},n.createElement(j.a,{client:this.client},this.props.children))}}]),t}(n.Component),De=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).setFields=function(t){e.setState(function(e){return{fields:Object(M.a)({},e.fields,t)}})},e.state={setFields:e.setFields,fields:{availableYears:[],availableCountries:[],selectedYear:null,selectedCountry:null,hoveredYear:null,hoveredCountry:null}},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.createElement(E.Provider,{value:this.state},this.props.children)}}]),t}(n.Component),Ae=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(we,null,r.a.createElement(De,null,r.a.createElement("div",{className:"App"},r.a.createElement(Ee,null))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[159,1,2]]]);
//# sourceMappingURL=main.b42f6aa4.chunk.js.map