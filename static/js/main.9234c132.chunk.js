(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{158:function(e,t,a){e.exports=a(281)},163:function(e,t,a){},164:function(e,t,a){},242:function(e,t,a){},255:function(e,t,a){},258:function(e,t,a){},259:function(e,t,a){},277:function(e,t,a){},281:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(10),o=a.n(i),c=(a(163),a(13)),s=a(14),l=a(16),u=a(15),p=a(17),d=(a(164),a(71),a(42)),h=a(65),f=(a(167),a(94)),m=a(39),b=(a(140),a(68)),g=(a(141),a(91)),y=a(32),v=a.n(y),O=a(40),j=n.createContext();function x(e){return function(t){return n.createElement(j.Consumer,null,function(a){return n.createElement(e,Object.assign({},t,{data:a}))})}}var C=n.createContext();function E(e){return function(t){return n.createElement(C.Consumer,null,function(a){return n.createElement(e,Object.assign({},t,{interaction:a}))})}}function S(){var e=Object(m.a)(["\n      {\n        countries\n      }\n    "]);return S=function(){return e},e}var k=g.a.Text,D=b.a.Option,w=E(x(function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){a.props.data.setQuery({countries:e||[]}),a.props.interaction.setFields({availableCountries:e||[]})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=v()(S());return r.a.createElement(O.b,{query:t},function(t){var a=t.loading,n=t.error,i=t.data;if(a)return"Loading...";n&&console.log("Error loading gql data for CountryPicker");var o=i.countries;return r.a.createElement("div",null,r.a.createElement(k,null,"Country"),r.a.createElement(b.a,{mode:"multiple",style:{width:"100%"},placeholder:"Please select",defaultValue:[],onChange:e.handleChange,value:e.props.interaction.fields.availableCountries},o.map(function(e){return r.a.createElement(D,{key:e},e)})))})}}]),t}(n.Component))),A=a(63),P=a(41),M=a(20),Y=a(149),F=a.n(Y),N=b.a.Option,R=function(e){return r.a.createElement(b.a,Object.assign({},e,{showSearch:!0,style:{width:200},placeholder:e.placeholder||"Select one",optionFilterProp:"children",onChange:function(t){e.handleChange(t)},filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}}),e.options.map(function(e,t){return r.a.createElement(N,{key:e.value||t,value:e.value||e},e.display||e)}))},L={"Grand Total - Animal Protein - Food supply":"Animal Protein","Grand Total - Carbs - Food supply":"Carbs","Grand Total - Fat - Food supply":"Fat","Grand Total - Food supply":"Grand Total","Grand Total - Plant Protein - Food supply":"Plant Protein","Grand Total - Protein - Food supply":"Protein"};a(242);function q(){var e=Object(m.a)(["\n      {\n        kcalRange {\n          max\n        }\n      }\n    "]);return q=function(){return e},e}var T={width:900,height:300,padding:50},z=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderXAxis()}},{key:"componentDidUpdate",value:function(){this.renderXAxis()}},{key:"renderXAxis",value:function(){var e=this.refs.axisContainer,t=M.a().ticks(5).tickFormat(M.e("d")).scale(this.props.scale);M.j(e).call(t)}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component),G=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderYAxis()}},{key:"componentDidUpdate",value:function(){this.renderYAxis()}},{key:"renderYAxis",value:function(){var e=this.refs.axisContainer,t=(this.props.flip?M.c():M.b()).ticks(5).scale(this.props.scale);M.j(e).call(t)}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component),W=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("g",{className:"LE-xy-axis"},r.a.createElement(z,{translate:"translate(0, ".concat(this.props.height-this.props.padding,")"),scale:this.props.xScale}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(".concat(T.width/2-this.props.padding/2,", ").concat(T.height-5,")")},"[year]"),r.a.createElement(G,{translate:"translate(".concat(this.props.padding,", 0)"),scale:this.props.yScale}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(10, ".concat(T.height/2,"), rotate(-90)")},"[total kCal]"),r.a.createElement(G,{translate:"translate(".concat(T.width-2*this.props.padding,", 0)"),scale:this.props.otherYScale,flip:!0}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(".concat(T.width-10,", ").concat(T.height/2,"), rotate(-90)")},"[Mean Age of Death]"))}}]),t}(r.a.Component),B=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"renderLine",value:function(e){return r.a.createElement("line",{x1:this.props.xScale(e[0]),y1:this.props.yScale(e[1]),x2:this.props.xScale(e[2]),y2:this.props.yScale(e[3]),strokeWidth:1.5,stroke:this.props.color})}},{key:"render",value:function(){return r.a.createElement("g",null,this.props.data.map(this.renderLine.bind(this)))}}]),t}(r.a.Component),V=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.xScale,a=e.yScale,n=e.data,i=e.color;return r.a.createElement(r.a.Fragment,null,r.a.createElement(X,{xScale:t,yScale:a,data:n,color:i}),r.a.createElement(B,{xScale:t,yScale:a,data:n,color:F()(i).darken(.1)}))}}]),t}(n.Component),X=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"renderFillBottom",value:function(e){return r.a.createElement("polygon",{points:"\n        ".concat(this.props.xScale(e[0]),",").concat(this.props.yScale(0),"\n        ").concat(this.props.xScale(e[2]),",").concat(this.props.yScale(0),"\n        ").concat(this.props.xScale(e[2]),",").concat(this.props.yScale(e[3]),"\n        ").concat(this.props.xScale(e[0]),",").concat(this.props.yScale(e[1]),"\n        "),fill:this.props.color})}},{key:"render",value:function(){return r.a.createElement("g",null,this.props.data.map(this.renderFillBottom.bind(this)))}}]),t}(r.a.Component),U=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"getXScale",value:function(){var e=this.props.interaction.fields.availableYears,t=e[0],a=e[e.length-1];return M.i().domain([t,a]).range([this.props.padding,this.props.width-2*this.props.padding])}},{key:"getDataYScale",value:function(){return M.i().domain([0,this.props.kcalMax]).range([this.props.height-this.props.padding,this.props.padding])}},{key:"getDeathYScale",value:function(){return M.i().domain([20,80]).range([this.props.height-this.props.padding,this.props.padding])}},{key:"render",value:function(){var e=this.getXScale(),t=this.getDataYScale(),a=this.getDeathYScale();return r.a.createElement("svg",{width:this.props.width,height:this.props.height},r.a.createElement(V,{xScale:e,yScale:t,data:this.props.measure4,color:"#70b678"}),r.a.createElement(V,{xScale:e,yScale:t,data:this.props.measure3,color:"#bbdbad"}),r.a.createElement(V,{xScale:e,yScale:t,data:this.props.measure2,color:"#c79fc8"}),r.a.createElement(V,{xScale:e,yScale:t,data:this.props.measure1,color:"#f4a58a"}),r.a.createElement(B,Object.assign({xScale:e,yScale:a},this.props,{data:this.props.deathData,color:"#444444"})),r.a.createElement(W,Object.assign({xScale:e,yScale:t,otherYScale:a},this.props)))}}]),t}(r.a.Component),Q=E(x(function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.processData()}},{key:"componentDidUpdate",value:function(e){e.data.data===this.props.data.data&&e.interaction.fields.selectedCountry===this.props.interaction.fields.selectedCountry||this.processData()}},{key:"processData",value:function(){console.log("processing");var e=this.props.interaction.fields.selectedCountry,t=[];e&&(t=this.props.data.data.map(function(t){return[t.year,t.countries.filter(function(t){return t.country===e})[0].items.reduce(function(e,t){return Object(P.a)({},e,Object(A.a)({},L[t.name],t.value))},{})]})),this.setState({data:t,totalData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1]["Grand Total"],a[t-1][0],a[t-1][1]["Grand Total"]]}).filter(function(e){return!!e}),deathData:t.map(function(e){return[e[0],65+10*(Math.random()-.5)]}).map(function(e,t,a){return 0===t?void 0:[e[0],e[1],a[t-1][0],a[t-1][1]]}).filter(function(e){return!!e}),carbData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1].Carbs,a[t-1][0],a[t-1][1].Carbs]}).filter(function(e){return!!e}),fatData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1].Carbs+e[1].Fat,a[t-1][0],a[t-1][1].Carbs+a[t-1][1].Fat]}).filter(function(e){return!!e}),animalProteinData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1].Carbs+e[1].Fat+e[1]["Animal Protein"],a[t-1][0],a[t-1][1].Carbs+a[t-1][1].Fat+a[t-1][1]["Animal Protein"]]}).filter(function(e){return!!e}),plantProteinData:t.map(function(e,t,a){return 0===t?void 0:[e[0],e[1].Carbs+e[1].Fat+e[1]["Animal Protein"]+e[1]["Plant Protein"],a[t-1][0],a[t-1][1].Carbs+a[t-1][1].Fat+a[t-1][1]["Animal Protein"]+a[t-1][1]["Plant Protein"]]}).filter(function(e){return!!e})})}},{key:"render",value:function(){var e=this,t=v()(q());return r.a.createElement(d.a,{title:r.a.createElement("div",null,r.a.createElement("span",null,'"Life Expectancy v. Total kCal Consumption"'),r.a.createElement(R,{options:this.props.interaction.fields.availableCountries||[],handleChange:function(t){return e.props.interaction.setFields({selectedCountry:t})},disabled:this.props.data.loading||!this.props.interaction.fields.availableCountries}))},r.a.createElement(O.b,{query:t},function(t){var a=t.loading,n=t.error,i=t.data;if(e.props.data.loading||a)return"Loading...";n&&console.log("Error loading gql data for LineChart");var o=i.kcalRange.max;return e.props.interaction.fields.selectedCountry?r.a.createElement(U,Object.assign({},e.props,{data:e.state.totalData,deathData:e.state.deathData,measure1:e.state.carbData,measure2:e.state.fatData,measure3:e.state.animalProteinData,measure4:e.state.plantProteinData,kcalMax:o},T)):"select a country"}))}}]),t}(r.a.Component))),J=(a(255),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).renderAxis=function(){var e=a.refs.axisContainer,t=("bottom"===a.props.orient?M.a():"left"===a.props.orient?M.b():null).ticks(5).scale(a.props.scale);M.j(e).call(t)},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderAxis()}},{key:"componentDidUpdate",value:function(){this.renderAxis()}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component)),I=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.settings;return r.a.createElement("g",{className:"xy-axis"},r.a.createElement(J,{translate:"translate(0, ".concat(e.height-e.padding,")"),scale:this.props.xScale,orient:"bottom"}),r.a.createElement(J,{translate:"translate(".concat(e.padding,", 0)"),scale:this.props.yScale,orient:"left"}))}}]),t}(r.a.Component),$=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderCircle=function(e){return r.a.createElement("circle",{cx:a.props.xScale(e[0]),cy:a.props.yScale(e[1]),r:2,key:1*Math.random()})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("g",null,this.props.data.map(this.renderCircle))}}]),t}(r.a.Component),H=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getXScale=function(){var e=a.props.settings,t=M.f(a.props.data,function(e){return e[0]});return M.i().domain([0,t]).range([e.padding,e.width-2*e.padding])},a.getYScale=function(){var e=a.props.settings,t=M.f(a.props.data,function(e){return e[1]});return M.i().domain([0,t]).range([e.height-e.padding,e.padding])},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.settings,t=e.xScale||this.getXScale(),a=e.yScale||this.getYScale();return r.a.createElement("svg",{width:e.width,height:e.height},r.a.createElement($,Object.assign({xScale:t,yScale:a},this.props)),r.a.createElement(I,Object.assign({xScale:t,yScale:a},this.props)))}}]),t}(r.a.Component),K=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).randomizeData=function(){var e=a.props.settings,t=M.h(e.numDataPoints).map(function(){return[Math.floor(Math.random()*e.maxRange()),Math.floor(Math.random()*e.maxRange())]});a.setState({data:t})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.randomizeData()}},{key:"render",value:function(){var e=this.props.settings;return r.a.createElement(d.a,{title:"Sample Scatterplot"},r.a.createElement(H,{data:this.state.data,settings:e}),r.a.createElement("div",{className:"controls"},r.a.createElement("button",{className:"btn randomize",onClick:this.randomizeData},"Randomize Data")))}}]),t}(n.Component);K.defaultProps={settings:{width:350,height:350,padding:30,numDataPoints:50,maxRange:function(){return 1e3*Math.random()}}};var Z=x(K),_=a(154),ee=a(66),te=a.n(ee),ae=a(90),ne=(a(258),["ALIGN","FOLLOW"]),re=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).renderAxis=function(){var e=a.refs.axisContainer,t=("bottom"===a.props.orient?M.a():"top"===a.props.orient?M.d():"left"===a.props.orient?M.b():null).ticks(5).scale(a.props.scale);M.j(e).call(t)},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.renderAxis()}},{key:"componentDidUpdate",value:function(){this.renderAxis()}},{key:"render",value:function(){return r.a.createElement("g",{className:"axis",ref:"axisContainer",transform:this.props.translate})}}]),t}(r.a.Component),ie=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.settings,t=e.padding,a=e.width,n=e.height,i=e.mode;return r.a.createElement("g",{className:"xy-axis"},r.a.createElement(re,{translate:"translate(0, ".concat(t,")"),scale:this.props.xScale,orient:"top"}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:"translate(".concat(a/2,", 15)")},"[kCal / person / day]"),r.a.createElement(re,{translate:i===i[1]?"translate(".concat(t,", 0)"):"translate(".concat(a/2,", 0)"),scale:this.props.yScale,orient:"left"}),r.a.createElement("text",{className:"axis",textAnchor:"middle",transform:i===ne[1]?"translate(".concat(t,", ").concat(n-t+15,")"):"translate(".concat(a/2,", ").concat(n-t+15,")")},"[year]"))}}]),t}(r.a.Component),oe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).renderRect=function(e){var t=a.props.settings;if(t.mode===ne[0])var n=t.width/2-a.props.xScale(e.xDiff),i=Math.abs(n),o=n>0?a.props.xScale(e.xDiff):t.width/2;else t.mode===ne[1]&&(n=a.props.xScale(e.xAbs)-a.props.xScale(e.xLast),i=Math.abs(n),o=e.xDiff>0?a.props.xScale(e.xLast):a.props.xScale(e.xAbs));return r.a.createElement("rect",{x:o,y:a.props.yScale(e.year),width:i,height:(t.height-2*t.padding)/t.numDataPoints,className:e.xDiff>0?"goodBar":"badBar",key:1*Math.random()})},a.renderRectText=function(e){var t=a.props.settings;if(t.mode===ne[0])var n=t.width/2-a.props.xScale(e.xDiff),i=t.width/2-n;else t.mode===ne[1]&&(n=a.props.xScale(e.xAbs)-a.props.xScale(e.xLast),i=a.props.xScale(e.xLast)+(e.xDiff>0?3:-3));return r.a.createElement("text",{textAnchor:e.xDiff>0?"start":"end",x:i,y:a.props.yScale(e.year)+t.height/t.numDataPoints/2+3,key:1*Math.random()},e.xDiff>0&&"+",e.xDiff.toFixed(1))},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("g",null,this.props.data.map(this.renderRect),this.props.data.map(this.renderRectText))}}]),t}(r.a.Component),ce=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getXScale=function(){var e=a.props.settings;if(e.mode===ne[0])var t=M.g(a.props.data,function(e){return e.xDiff}),n=M.f(a.props.data,function(e){return e.xDiff});else e.mode===ne[1]&&(t=M.g(a.props.data,function(e){return e.xAbs}),n=M.f(a.props.data,function(e){return e.xAbs}));var r=M.f([Math.abs(t),Math.abs(n)]);return M.i().domain([e.mode===ne[0]?-r:t,r]).range([e.padding,e.width-e.padding])},a.getYScale=function(){var e=a.props.settings,t=M.g(a.props.data,function(e){return e.year}),n=M.f(a.props.data,function(e){return e.year});return M.i().domain([t,n+1]).range([e.padding,e.height-e.padding])},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.settings,t=this.props.xScale||this.getXScale(),a=this.props.xScale||this.getYScale();return r.a.createElement("svg",{width:e.width,height:e.height},r.a.createElement(oe,Object.assign({xScale:t,yScale:a},this.props)),r.a.createElement(ie,Object.assign({xScale:t,yScale:a},this.props)))}}]),t}(r.a.Component),se=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={mode:ne[1],data:[]},a.toggleMode=function(){var e=a.state.mode;e===ne[0]?a.setState({mode:ne[1]}):e===ne[1]&&a.setState({mode:ne[0]})},a.processData=function(){var e=a.props.data.map(function(e,t,a){return 0!==t?{year:e[0],xLast:a[t-1][1],xDiff:e[1]-a[t-1][1],xAbs:e[1]}:null}).filter(function(e){return!!e});a.setState({data:e})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.processData()}},{key:"componentDidUpdate",value:function(e){e.data!==this.props.data&&this.processData()}},{key:"render",value:function(){var e=this.props,t=e.settings,a=e.country,n=e.group;return r.a.createElement(d.a,{title:"".concat(a," - ").concat(L[n])},r.a.createElement(ce,{data:this.state.data,settings:Object(P.a)({},t,{numDataPoints:this.state.data.length+1,mode:this.state.mode})}),r.a.createElement("div",{className:"controls"},r.a.createElement("button",{className:"btn randomize",onClick:this.toggleMode},"Toggle Mode"),r.a.createElement("button",{className:"btn randomize",onClick:this.processData},"Randomize Data")))}}]),t}(n.Component);se.defaultProps={settings:{width:300,height:400,padding:40,baseYear:1985,numDataPoints:30,maxRange:function(){return 100*Math.random()}}};var le=se,ue=(a(95),a(92));a(259);function pe(){var e=Object(m.a)(["\n      {\n        names(type: MACRO)\n      }\n    "]);return pe=function(){return e},e}var de=E(function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.interaction.fields.availableCountries,a=this.props,n=a.country,i=a.group,o=v()(pe()),c=function(t){return function(a){e.props.handleChange(Object(A.a)({},t,a))}};return r.a.createElement(O.b,{query:o},function(a){var o=a.loading,s=a.error,l=a.data;return s&&console.log("Error loading gql data for YearSlider"),r.a.createElement(d.a,{title:"Waterfall Config",loading:o},!o&&r.a.createElement("div",{className:"WaterfallConfig"},r.a.createElement(R,{placeholder:"Select a country",options:t,handleChange:c("country"),value:n||void 0}),r.a.createElement(R,{placeholder:"Select a group",options:l.names.map(function(e){return{value:e,display:L[e]}}),handleChange:c("group"),value:i||void 0}),r.a.createElement(ue.a,{type:"primary",onClick:e.props.toggleView},"Visualize")))})}}]),t}(n.Component)),he=x(function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={displayConfig:!0,country:null,group:null,data:[]},a.toggleView=function(){a.setState(function(e){return{displayConfig:!e.displayConfig}})},a.handleChange=function(){var e=Object(ae.a)(te.a.mark(function e(t){return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState(Object(P.a)({},t));case 2:a.filterData();case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.filterData=function(){var e=a.state,t=e.country,n=e.group,r=[];t&&n&&(r=a.props.data.data.map(function(e){return[e.year,e.countries.filter(function(e){return e.country===t})[0].items.filter(function(e){return e.name===n})[0].value]})),a.setState({data:r})},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){e.data.data!==this.props.data.data&&this.filterData()}},{key:"render",value:function(){var e=this.state,t=e.data,a=Object(_.a)(e,["data"]);return r.a.createElement("div",null,this.state.displayConfig?r.a.createElement(de,Object.assign({handleChange:this.handleChange,toggleView:this.toggleView},a)):r.a.createElement(le,Object.assign({},this.props,a,{toggleView:this.toggleView,data:t})))}}]),t}(n.Component)),fe=(a(260),a(152));function me(){var e=Object(m.a)(["\n      {\n        yearRange {\n          min\n          max\n        }\n      }\n    "]);return me=function(){return e},e}var be=g.a.Text,ge=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleRelease=function(e){var t=Object(h.a)(Array(e[1]-e[0]+1).keys()).map(function(t){return e[0]+t});a.props.data.setQuery({years:t}),a.props.interaction.setFields({availableYears:t})};var n=a.props,r=n.min,i=n.max;return a.handleRelease([r,i]),a.state={value:[r,i]},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.interaction.fields.availableYears;e.interaction.fields.availableYears!==t&&this.setState({value:[t[0],t[t.length-1]]})}},{key:"render",value:function(){var e=this.props,t=e.min,a=e.max;return r.a.createElement("div",null,r.a.createElement(be,null,"Year"),r.a.createElement(fe.a,{range:!0,min:t,max:a,onAfterChange:this.handleRelease,value:this.state.value}))}}]),t}(n.Component),ye=E(x(function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=v()(me());return r.a.createElement(O.b,{query:t},function(t){var a=t.loading,n=t.error,i=t.data;if(a)return"Loading...";n&&console.log("Error loading gql data for YearSlider");var o=i.yearRange,c=o.min,s=o.max;return r.a.createElement(ge,Object.assign({},e.props,{min:c,max:s}))})}}]),t}(n.Component))),ve=(a(277),E(x(function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){var e=a.props,t=e.yearRange,n=e.countries,r=e.selectedYear,i=e.selectedCountry,o={},c={};if(t){var s=Object(h.a)(Array(t[1]-t[0]+1).keys()).map(function(e){return t[0]+e});o.years=s,c.availableYears=s}n&&(o.countries=n,c.availableCountries=n),r&&(c.selectedYear=r),i&&(c.selectedCountry=i),0!==Object.keys(o).length&&a.props.data.setQuery(o),0!==Object.keys(c).length&&a.props.interaction.setFields(c)},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(ue.a,{onClick:this.handleClick},this.props.children)}}]),t}(n.Component)))),Oe=f.a.Sider,je=f.a.Content,xe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={waterfalls:[]},a}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(f.a,{style:{height:"100vh"}},r.a.createElement(Oe,{theme:"light",className:"sideBar"},r.a.createElement("h1",{className:"App-title"},"Nutrition InfoViz"),r.a.createElement(w,null),r.a.createElement(ye,null),r.a.createElement(ve,{countries:["Canada","Afghanistan","Mexico"],yearRange:[1990,2e3]},"Preset 1")),r.a.createElement(je,{className:"dashboard"},r.a.createElement(Z,null),r.a.createElement(Q,null),this.state.waterfalls,r.a.createElement(d.a,{onClick:function(){return e.setState({waterfalls:[].concat(Object(h.a)(e.state.waterfalls),[r.a.createElement(he,null)])})},style:{width:375}},"Click to add Waterfall")))}}]),t}(n.Component),Ce=a(153);function Ee(){var e=Object(m.a)(["\n          {\n            itemByYearCountry(\n              ","\n              ","\n              ","\n            )\n              {\n              year\n              countries {\n                country\n                items {\n                  country\n                  year\n                  type\n                  name\n                  value\n                }\n              }\n            }\n          }\n        "]);return Ee=function(){return e},e}var Se=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).setQuery=function(){var t=Object(ae.a)(te.a.mark(function t(a){return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState(function(e){return{queryParams:Object(P.a)({},e.queryParams,a)}});case 2:e.getData();case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.setData=function(t){e.setState(function(e){return{data:t,loading:e.loading-1}})},e.getData=function(){var t=e.state.queryParams,a=t.years,n=t.countries,r=t.type;e.setState(function(e){return{loading:e.loading+1}}),e.client.query({query:v()(Ee(),a.length>0?"years:".concat(JSON.stringify(a),", "):"",n.length>0?"countries:".concat(JSON.stringify(n),", "):"",r?"type:".concat(r):"")}).then(function(t){return e.setData(t.data.itemByYearCountry)}).catch(function(e){return console.log(e)})},e.state={setDate:e.setData,setQuery:e.setQuery,data:[],queryParams:{type:"MACRO",countries:[],years:[]},loading:0},e.client=new Ce.a({uri:"http://localhost:4000/graphql"}),e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.createElement(j.Provider,{value:this.state},n.createElement(O.a,{client:this.client},this.props.children))}}]),t}(n.Component),ke=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).setFields=function(t){e.setState(function(e){return{fields:Object(P.a)({},e.fields,t)}})},e.state={setFields:e.setFields,fields:{availableYears:[],availableCountries:[],selectedYear:null,selectedCountry:null,hoveredYear:null,hoveredCountry:null}},e}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.createElement(C.Provider,{value:this.state},this.props.children)}}]),t}(n.Component),De=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(Se,null,r.a.createElement(ke,null,r.a.createElement("div",{className:"App"},r.a.createElement(xe,null))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(De,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[158,1,2]]]);
//# sourceMappingURL=main.9234c132.chunk.js.map